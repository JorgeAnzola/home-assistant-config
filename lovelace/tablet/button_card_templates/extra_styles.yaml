extra_styles:
  extra_styles: >
    [[[
      if (entity) {
          if (entity.entity_id.split('.')[0] === 'light' && variables.state_on) {

              // theme variable and conditions
              let style = getComputedStyle(document.body),
                  theme_var = style.getPropertyValue('--button-card-light-color-temp'),
                  is_hsl = theme_var.startsWith('hsl('),
                  is_color_temp = entity.attributes.color_mode === 'color_temp';

              if (is_hsl && is_color_temp && entity.attributes.brightness) {

                  // calculate lightness in hsl
                  let regex_pattern = /(\d+)(?!.*\d)/g,
                      brightness = entity.attributes.brightness / 2.54,
                      lightness = parseFloat(theme_var.match(regex_pattern)[0]),
                      min = lightness - 10,
                      max = lightness + 10,
                      calc_lightness = brightness * (max - min) / 100 + min;

                  var light_color = theme_var.replace(regex_pattern, calc_lightness);
              }
              else {
                  var light_color = 'var(--button-card-light-color)';
              }
          }
      }
      return `

       /* * * * * * * * * * * * * * * * * *
        *                                 *
        *              LIGHT              *
        *                                 *
        * * * * * * * * * * * * * * * * * */

        svg {
          --light-color: ${
            variables.state_on && entity.attributes.brightness
                ? light_color
                : variables.state_on && !entity.attributes.brightness
                    ? 'var(--state-icon-active-color);'
                    : 'var(--state-icon-color);' }
        }

        .light-color {
          fill: var(--light-color);
          transition: all 0.25s ease-out;
        }

        /* magnification */
        :host {
          --card-portrait: 1.4;
          --card-phone: 2.271;
        }

        ${this._config.template.includes('light') ? `

         /* * * * * * * * * * * * * * * * * *
          *                                 *
          *          CIRCLE SLIDER          *
          *                                 *
          * * * * * * * * * * * * * * * * * */

          #circle_slider {
            opacity: 0;
            appearance: none;
            transform: rotate(270deg);
            width: 90%;
            position: absolute;
            pointer-events: none;
            cursor: grab;
            left: 26%;
            margin-top: 13%;
          }

          #circle_slider::-webkit-slider-thumb {
            pointer-events: initial;
            appearance: none;
            width: 3vw;
            height: 3vw;
            border-radius: 50%;
            background: green;
          }

          #circle_slider::-webkit-slider-runnable-track {
            background: cornflowerblue;
          }

          #circle_slider::-moz-range-thumb {
            pointer-events: initial;
            appearance: none;
            width: 3vw;
            height: 3vw;
            border-radius: 50%;
            background: green;
          }

          #circle_slider::-moz-range-track {
            background: cornflowerblue;
            height: 3vw;
          }


        `:''}

       /* * * * * * * * * * * * * * * * * *
        *                                 *
        *              BASE               *
        *                                 *
        * * * * * * * * * * * * * * * * * */

        #container {
          text-align: left !important;
          z-index: 1;
        }

        #card {
          padding: 10.9% 9.9% 8.9% 10.9%;
        }

        #state::first-letter {
          text-transform: uppercase;
        }

        #name, #state {
          font-size: var(--button-card-font-size);
          font-weight: var(--button-card-font-weight);
          letter-spacing: var(--button-card-letter-spacing);
        }

        ${this._config.template.includes('conditional_media') ? `

         /* * * * * * * * * * * * * * * * * *
          *                                 *
          *              MEDIA              *
          *                                 *
          * * * * * * * * * * * * * * * * * */

          :host {
            --blur-intensity: blur(4.5px) brightness(0.8);
          }

          #ripple, .js-tilt-glare {
            clip-path: inset(0 round calc(var(--button-card-border-radius) / 2));
          }

          #container {
            overflow: hidden;
          }

          .marquee {
            animation: marquee 20s linear infinite;
          }

          @keyframes marquee {
            from {
              transform: translateX(0%);
            }
            to {
              transform: translateX(-50%);
            }
          }

        `:''}

        ${this._config.template.includes('footer') ? `

         /* * * * * * * * * * * * * * * * * *
          *                                 *
          *             FOOTER              *
          *                                 *
          * * * * * * * * * * * * * * * * * */

          /* magnification */
          :host {
            --footer-portrait: 1.4;
            --footer-phone: 2.8;
          }

          #ripple, .js-tilt-glare {
            border-radius: calc(var(--footer-card-border-radius) - 0.1vw);
            clip-path: inset(0 round calc( var(--button-card-border-radius) - 0.1vw ));
          }

          #name {
            font-size: var(--footer-card-font-size);
            padding: var(--footer-card-padding-v) var(--footer-card-padding-h);
            letter-spacing: 0.05vw;
          }

          ha-icon {
            width: var(--footer-card-icon-size);
            vertical-align: 7%;
            padding-right: 0.1vw;
            opacity: 0.4;
          }

          #card {
            border-radius: var(--footer-card-border-radius);
            background: rgba(115, 115, 115, 0.10);
          }

          #notify {
            font-size: var(--footer-notify-font-size);
            width: var(--footer-notify-box-size);
            height: var(--footer-notify-box-size);
            line-height: var(--footer-notify-box-size);
            padding-right: 0.5%;
            padding-top: 0.5%;
            top: var(--footer-notify-top);
            right: var(--footer-notify-right);
          }

        `:''}
      `;
    ]]]
